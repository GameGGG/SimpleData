{"version":3,"file":"index.js","sources":["../src/core.js","../src/reverse.js","../src/number.js","../src/string.js","../src/index.js"],"sourcesContent":["/**\n * Created by prefrence on 2021/02/09\n * @file core\n * @author white_g <mganxiaolei@gmail.com>\n */\n\nclass DataAdapter {\n  constructor(data) {\n    this.data = data;\n  }\n\n  transData(data, computes = []) {\n    if (computes.length === 0) {\n      return data;\n    }\n    const compute = computes.shift();\n    const computeArr = compute.split(':');\n    let result = data;\n    const handleFunc = DataAdapter.filterMap[computeArr[0]];\n    if (handleFunc) {\n      result = handleFunc(data);\n    }\n    return this.transData(result, computes);\n  }\n\n  get(schema, defaultValue) {\n    // string类型拆分\n    let opt;\n    if (Array.isArray(schema)) {\n      opt = schema;\n    } else if ((typeof schema).toLowerCase() === 'string') {\n      opt = schema.split('.');\n    } else if ((typeof schema).toLowerCase() === 'object') {\n      const result = {};\n      Object.keys(schema).forEach(key => {\n        result[key] = this.get(schema[key], defaultValue);\n      });\n      return result;\n    }\n\n    return opt.reduce((prevData, item) => {\n      const arr = item.split('|');\n      key = arr.shift();\n      if (prevData && prevData[key]) {\n        return this.transData(prevData[key], arr);\n      }\n      return defaultValue;\n    }, this.data);\n  }\n\n  // 新增过滤器\n  static addFilter(name, func) {\n    let filterName = name;\n    let filterHandle = func;\n    if ((typeof name).toLocaleLowerCase() !== 'string') {\n      filterHandle = name;\n      filterName = func.filterName;\n    }\n    if (DataAdapter.filterMap[filterName]) {\n      throw new Error('存在重复的过滤器名称');\n    }\n    DataAdapter.filterMap[filterName] = filterHandle;\n  }\n}\n\nDataAdapter.filterMap = {};\n\nexport default DataAdapter;\n\n","function reverseFilterHandle() {\n  if (Array.isArray(res)) {\n    return res.reverse();\n  }\n  return res;\n}\n\nreverseFilterHandle.filterName = 'reverse';\n\nexport default reverseFilterHandle;","function numberFilterHandle(val) {\n  if (Array.isArray(val)) {\n    return val.map(item => Number(item));\n  }\n  return Number(val);\n}\n\nnumberFilterHandle.filterName = 'number';\n\nexport default numberFilterHandle;\n","function stringFilterHandle(val) {\n  if (Array.isArray(val)) {\n    return val.map(item => String(item));\n  }\n  return String(val);\n}\n\nstringFilterHandle.filterName = 'string';\n\nexport default stringFilterHandle;","// core\nimport DataAdapter from './core';\n\n// 过滤器\nimport reverse from './reverse';\nimport number from './number';\nimport string from './string';\n\nDataAdapter.addFilter(reverse);\nDataAdapter.addFilter(number);\nDataAdapter.addFilter(string);\n\nexport default DataAdapter;\n"],"names":["DataAdapter","data","computes","length","compute","shift","computeArr","split","result","handleFunc","filterMap","this","transData","schema","defaultValue","opt","Array","isArray","_typeof","toLowerCase","Object","keys","forEach","key","_this","get","reduce","prevData","item","arr","name","func","filterName","filterHandle","toLocaleLowerCase","Error","reverseFilterHandle","res","reverse","numberFilterHandle","val","map","Number","stringFilterHandle","String","addFilter","number","string"],"mappings":"qnBAMMA,wBACQC,0BACLA,KAAOA,6CAGd,SAAUA,OAAMC,yDAAW,MACD,IAApBA,EAASC,cACJF,MAEHG,EAAUF,EAASG,QACnBC,EAAaF,EAAQG,MAAM,KAC7BC,EAASP,EACPQ,EAAaT,EAAYU,UAAUJ,EAAW,WAChDG,IACFD,EAASC,EAAWR,IAEfU,KAAKC,UAAUJ,EAAQN,sBAGhC,SAAIW,EAAQC,OAENC,YACAC,MAAMC,QAAQJ,GAChBE,EAAMF,OACD,GAAsC,WAAlCK,UAAQL,GAAQM,cACzBJ,EAAMF,EAAON,MAAM,UACd,GAAsC,WAAlCW,UAAQL,GAAQM,cAA4B,KAC/CX,EAAS,UACfY,OAAOC,KAAKR,GAAQS,SAAQ,SAAAC,GAC1Bf,EAAOe,GAAOC,EAAKC,IAAIZ,EAAOU,GAAMT,MAE/BN,SAGFO,EAAIW,QAAO,SAACC,EAAUC,OACrBC,EAAMD,EAAKrB,MAAM,YACvBgB,IAAMM,EAAIxB,QACNsB,GAAYA,EAASJ,KAChBC,EAAKZ,UAAUe,EAASJ,KAAMM,GAEhCf,IACNH,KAAKV,iCAIV,SAAiB6B,EAAMC,OACjBC,EAAaF,EACbG,EAAeF,KACuB,WAAtCb,UAAQY,GAAMI,sBAChBD,EAAeH,EACfE,EAAaD,EAAKC,YAEhBhC,EAAYU,UAAUsB,SAClB,IAAIG,MAAM,cAElBnC,EAAYU,UAAUsB,GAAcC,WC7DxC,SAASG,WACHpB,MAAMC,QAAQoB,KACTA,IAAIC,UAEND,ICJT,SAASE,EAAmBC,UACtBxB,MAAMC,QAAQuB,GACTA,EAAIC,KAAI,SAAAb,UAAQc,OAAOd,MAEzBc,OAAOF,GCJhB,SAASG,EAAmBH,UACtBxB,MAAMC,QAAQuB,GACTA,EAAIC,KAAI,SAAAb,UAAQgB,OAAOhB,MAEzBgB,OAAOJ,UH6DhBxC,EAAYU,UAAY,GC1DxB0B,EAAoBJ,WAAa,UCAjCO,EAAmBP,WAAa,SCAhCW,EAAmBX,WAAa,SCChChC,EAAY6C,UAAUP,GACtBtC,EAAY6C,UAAUC,GACtB9C,EAAY6C,UAAUE"}